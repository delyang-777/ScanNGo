{% extends 'base.html' %}

{% block content %}
<div style="height: 100vh; display: flex; flex-direction: column; background: #0f0f1f;">

    <!-- Fixed Header -->
    <div style="
        position: fixed; top: 0; left: 0; right: 0;
        display: flex; align-items: center; gap: 10px;
        padding: 15px; background: rgba(15,15,31,0.95);
        box-shadow: 0 2px 10px rgba(0,255,255,0.3); z-index: 999;
    ">
        <a href="{{ url_for('admin_dashboard') }}"
           style="display: inline-flex; align-items: center; justify-content: center;
                  padding: 8px 14px; background: linear-gradient(135deg, #00f6ff, #00fff6);
                  color: #0f0f1f; font-weight: bold; font-size: 1.1em; border-radius: 30px;
                  text-decoration: none;">
            &#8592;
        </a>

        <h2 style="color: #00f6ff; font-family: 'Orbitron', sans-serif; font-size: 2em; margin: 0;">
            Manage Members
        </h2>
    </div>

    <div style="height: 90px;"></div>

    <!-- Action Buttons -->
    <div style="text-align: center; margin-bottom: 15px; display:flex; gap:10px; flex-wrap: wrap; justify-content:center;">
        <button class="action-btn" id="add-member-btn">Add Member</button>
    </div>

    <!-- Members Table -->
    <div style="flex: 1; overflow-y: auto; padding: 0 15px;">
        <div style="overflow-x: auto;">
            <table style="width:100%; border-collapse: collapse; color: #fff; min-width: 900px;">
                <thead>
                    <tr style="background: #00f6ff; color: #0f0f1f; position: sticky; top: 0; z-index: 2;">
                        <th style="padding: 10px;">ID</th>
                        <th style="padding: 10px;">Name</th>
                        <th style="padding: 10px;">Email</th>
                        <th style="padding: 10px;">Role</th>
                        <th style="padding: 10px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for member in members %}
                    <tr style="border-bottom: 1px solid #00f6ff33;">
                        <td style="padding: 10px;">{{ member.id }}</td>
                        <td style="padding: 10px;">{{ member.username }}</td>
                        <td style="padding: 10px;">{{ member.email }}</td>
                        <td style="padding: 10px;">{{ member.role }}</td>
                        <td style="padding: 10px; display:flex; gap:5px;">
                            <button class="action-btn view-btn" onclick="window.location.href='/admin/members/view/{{ member.id }}'">View</button>
                            <button class="action-btn edit-btn" onclick="window.location.href='/admin/members/edit/{{ member.id }}'">Edit</button>
                            <form method="GET" action="{{ url_for('remove_member', member_id=member.id) }}" style="display:inline;" onsubmit="return confirm('Are you sure you want to delete this member?');">
                                <button type="submit" class="action-btn delete-btn">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="5" style="text-align:center; color:#aaa; padding:20px;">
                            No members found.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pending Updates Section -->
        {% if pending_updates %}
        <h3 style="color:#00f6ff; margin-top: 20px; text-align:center;">Pending Updates</h3>
        {% for update in pending_updates %}
        <div style="border:1px solid #00f6ff; padding:15px; margin-bottom:10px; border-radius:10px; color:#fff;">
            <p><strong>User:</strong> {{ update.user.username }}</p>
            <p><strong>Email:</strong> {{ update.email }}</p>
            <p><strong>Full Name:</strong> {{ update.full_name }}</p>
            <p><strong>Age:</strong> {{ update.age }}</p>
            <!-- other fields... -->
            <form method="POST" action="{{ url_for('approve_update', update_id=update.id) }}" style="display:inline;">
                <button type="submit" style="background:green; color:#fff; padding:5px 10px; border:none; border-radius:5px;">Approve</button>
            </form>
            <form method="POST" action="{{ url_for('reject_update', update_id=update.id) }}" style="display:inline;">
                <button type="submit" style="background:red; color:#fff; padding:5px 10px; border:none; border-radius:5px;">Reject</button>
            </form>
        </div>
        {% endfor %}
        {% endif %}

    </div>
</div>

<style>
body { background-color: #0f0f1f; font-family: 'Poppins', sans-serif; margin:0; }

.action-btn {
    background-color: #1a1a2e;
    color: #fff;
    font-weight: 500;
    padding: 8px 16px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
}

.action-btn:hover { background-color: #2e2e4d; transform: translateY(-2px); }

.view-btn { background-color: #00b894; }
.view-btn:hover { background-color: #019874; }

.edit-btn { background-color: #007bff; }
.edit-btn:hover { background-color: #0056b3; }

.delete-btn { background-color: #dc3545; }
.delete-btn:hover { background-color: #a71d2a; }

@media (max-width: 600px) { table { min-width: 750px; } }
</style>

<script>
document.getElementById('add-member-btn').addEventListener('click', function() {
    window.location.href = "{{ url_for('add_member') }}";
});
</script>
{% endblock %}
